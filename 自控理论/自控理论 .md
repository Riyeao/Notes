# 自控理论

## 控制系统的数学模型

+ 术语定义

  r(t)输入信号

  b(t)反馈

  e(t)误差

  G~n~控制单元/控制对象

  u(t)控制量

  n(t)扰动信号

  y(t)输出信号

  H反馈单元

​		上述小写字母的拉普拉斯变换为大写

### 传递函数

对线性定常控制系统，其微分表达式为

$\sum\limits_{i=1}^{n}a_{i}y^{(i)}(t)=\sum\limits_{j=1}^{m}b_{j}r^{(j)}(t)$

​	 其中系数等为结构和参数相关的实常数，对实际系统有n大于等于m，并且在零初始条件下，除y和r的最高阶导数外，其他阶次项在0处的值均为0

取拉普拉斯变换有

$\sum\limits_{i=1}^{n}a_{i}s^{i}Y(s)=\sum\limits_{j=1}^{m}b_{j}s^{j}R(s)$

设$G(s)=\frac{Y(s)}{R(s)}=\frac{\sum\limits_{j=0}^{m}b_{j}s^{j}}{\sum\limits_{i=0}^{n}a_{i}s^{i}}$为该系统的传递函数

注：传递函数是在零状态条件下的，只描述系统外部特性的函数

上式中分子的零点称为G的零点，分母的零点称为G的极点（特征根），当这些零点为复数时必为共轭复数。

当极点的实部为负时，时间趋于无穷时函数收敛，系统稳定；输入一定时，输出的曲线形状由零点和极点决定

+ 典型环节的传递函数

  1. 比例环节

  $y(t)=Kr(t),G(s)=K$

  2. 惯性环节（一阶系统）

  $T\dot y(t)+y(t)=Kr(t),G(s)=\frac{K}{Ts+1}$ 
  3. 积分环节

     $y(t)=K\int r(t)dt ~~~~(t\ge0),G(s)=\frac{K}{s}=\frac{1}{Ts}$

     T为积分时间常数

  4. 微分环节

     $y(t)=\tau\frac{d r(t)}{dt}~~~~(t\ge0),G(s)=\tau s$

     τ为时间常数

  5. 振荡环节

     $T^2\frac{d^2}{dt^2}y(t)+2\zeta T\frac{d}{dt}y(t)+y(t)=Kr(t),G(s)=\frac{K}{T^2s^2+2\zeta Ts+1}$

     T为时间常数，ζ为阻尼系数，ζ在0到1之间时，环节具有一对复数极点

     以输入信号为单位阶跃为例，ζ越小振荡越剧烈，为0时为正弦，ζ大于等于1时响应不再振荡

  6. 延迟环节

     $y(t)=r(t-\tau),G(s)=e^{-\tau s}$

  ### 动态结构图

  形如,为动态结构图![image-20240108143058984](D:\allProject\markdown\自控理论\image-20240108143058984.png)

环节串联，传递函数相乘

环节并联，传递函数相加

反馈环节，对负反馈$G_B(s)=\frac{G(s)}{1+G(s)H(s)}$，对正反馈，分母取负号

![图片2](D:\allProject\markdown\自控理论\图片2.png)![图片1](D:\allProject\markdown\自控理论\图片1.png)

### 信号流图

使用有向图形式表示的系统结构

前向通道：从输入节点到输出节点，每个节点只经过一次的通道

不接触回环：没有公共节点的回环

化简规则

![图片3](D:\allProject\markdown\自控理论\图片3.png)

梅逊增益公式：

$G(s)=\frac{\sum\limits_{k=1}^nP_k\Delta_k}{\Delta}$

其中$\Delta=1-\sum L_i+\sum L_iL_j-\sum L_iL_jL_k...$,L为独立回路，相乘的为互不接触的独立回路，P~k~为第k条前向通道的传递函数，Δ~k~为与第k条前向通道不接触部分的Δ值。

### 控制系统的传递函数

1. 开环传递函数

   $G_K(s)=\frac{B(s)}{E(s)}$,为断开系统主反馈通路得到的传递函数

2. r作用下的闭环传递函数

   不考虑扰动信号，令G~1~为控制单元，G~2~为控制对象，则

   $G_B(s)=\frac{Y(s)}{R(s)}=\frac{G_1(s)G_2(s)}{1+G_1(s)G_2(s)H(s)}$

   $Y_r(s)=R(s)G_B(s)$

3. n对系统的影响

   $G_n(s)=\frac{Y(s)}{N(s)}=\frac{G_2(s)}{1+G_1(s)G_2(s)H(s)}$

   $Y_n(s)=N(s)G_n(s)$

4. 系统总输出

   $Y(s)=Y_r(s)+Y_n(s)=R(s)G_B(s)+N(s)G_n(s)$

5. 闭环系统的误差传递函数

   e=r-b

   当只有输入时$G_{er}(s)=\frac{E(s)}{R(s)}=\frac{1}{1+G_1(s)G_2(s)H(s)}$

   当只有扰动时$G_{en}(s)=\frac{N(s)}{R(s)}=\frac{-G_2(s)H(s)}{1+G_1(s)G_2(s)H(s)}$

   总误差$E(s)=G_{er}(s)R(s)+G_{en}(s)N(s)$
   
###  线性系统的状态空间

设系统状态向量为**x**，输入变量向量为**u**，输出向量为**y**

定义$\dot {\textbf x}(t)=\textbf{f(x,u)}$为状态方程

​		${\textbf y}(t)=\textbf{g(x,u)}$为输出方程

线性化得

​	$\dot {\textbf x}=\textbf{Ax+Bu}$

​			${\textbf y}=\textbf{Cx+Du}$

​		**A**为状态矩阵，**B**为输入矩阵，**C**为输出矩阵，**D**为传输矩阵

​		由零状态条件和拉普拉斯变换解得

​		$\textbf X(s)=(s\textbf I-\textbf A)^{-1}\textbf{BU}(s)$

​		$\textbf Y(s)=[\textbf C(s\textbf I-\textbf A)^{-1}\textbf B+\textbf D]\textbf{U}(s)$

​		系统传递函数$\textbf G(s)=\frac{\textbf Y(s)}{\textbf X(s)}=\textbf C(s\textbf I-\textbf A)^{-1}\textbf B+\textbf D$

## 时域分析

对于系统的输出y，其一般由动态响应y~1~和稳态响应y~2~合成。动态响应指系统在典型输入下输出从初始状态到最终状态的响应，应在有限时间内完成；稳态响应则是指时间趋于无穷大时系统在典型输入下的输出，一般反映控制精度

最大超调量:$\sigma\%=\frac{y_{max}-y(\infty)}{y(\infty)}100\%$

延迟时间t~d~：输出第一次达到稳态值的50%

上升时间t~r~：输出第一次达到稳态值或者从稳态值的10%到90%所用的时间

峰值时间t~p~：输出超过稳态达到第一个峰值的时间

调节时间t~s~：输出与稳态值的误差不再超过某范围（一般为稳态值的2%或5%）所用的时间

振荡次数N：调节时间内的输出偏离稳态的次数

### 一阶系统

  $G=\frac{1}{Ts+1}$

  1. 单位阶跃响应

     $y=1-e^{-\frac tT}$恐龙pp

     t=3T，误差为5%；t=4T，误差为2%

  2. 单位斜坡响应

     $y=t-T+Te^{-\frac tT}$

     T越小，稳态误差越小

  3. 单位脉冲响应

     $y=\frac1Te^{-\frac tT}$

### 二阶系统

  $G(s)=\frac{\omega_n^2}{s(s+2\zeta\omega_n)}$

  $G_B(s)=\frac{\omega_n^2}{s^2+2\zeta\omega_ns+\omega_n^2}$

特征方程为其分母，特征根为$s_1=-\frac 1{T_1}=-(\zeta-\sqrt{\zeta^2-1})\omega_n,s_2=-\frac 1{T_2}=-(\zeta+\sqrt{\zeta^2-1})\omega_n$

其中ζ为阻尼比，ω~n~为无阻尼自然振荡角频率

1. ζ＞1

   系统有两个不相等的负实数极点，s~2~小于s~1~，T~1~大于T~2~，$\omega_n^2=\frac 1{T_1T_2}$

   当输入单位阶跃时，$y=1+\frac {T_1}{T_2-T_1}e^{-\frac t{T_1}}+ \frac {T_2}{T_1-T_2}e^{-\frac t{T_2}}$

   主要考虑调节时间，$T_1>4T_2，if~~\zeta>1.25$调节时间约为3T~1~，此时可近似为一阶系统

2. ζ=1

   $s_1=s_2=-\omega_n$

   单位阶跃输入下$y=1-e^{-\omega_nt}(1+\omega_nt)$

3. 0＜ζ＜1

   $s_1,s_2=-\zeta \omega_n\pm\omega_n\sqrt{\zeta^2-1}=-\zeta \omega_n\pm j\omega_n\sqrt{1-\zeta^2}=-\zeta \omega_n\pm j\omega_d~~~~\omega_d=\omega_n\sqrt{1-\zeta^2}$

ω~d~为有阻尼自然振荡角频率，小于ω~n~

单位阶跃输入下$y=1-\frac{e^{-\zeta\omega_nt}}{\sqrt{1-\zeta^2}}\sin{(\omega_dt+\arctan{\frac{\sqrt{1-\zeta^2}}{\zeta}})}$

稳态误差为$e=\frac{e^{-\zeta\omega_nt}}{\sqrt{1-\zeta^2}}\sin{(\omega_dt+\arctan{\frac{\sqrt{1-\zeta^2}}{\zeta}})}$

ζω~n~常称为衰减系数

特别的，当ζ=0时，有$y=1-\cos{\omega_nt}$

$t_r=\frac{\arctan{(-\frac{\sqrt{1-\zeta^2}}{\zeta})}}{\omega_d}$

$t_p=\frac{\pi}{\omega_d}$

$\sigma=e^{-\pi\frac{\zeta}{\sqrt{1-\zeta^2}}}$

$t_S为近似值，通过包络线1\pm\frac{e^{-\zeta\omega_nt}}{\sqrt{1-\zeta^2}}取代y来近似求解$

$t_s=\frac 1{\zeta\omega_n}|\ln{\Delta\%\sqrt{1-\zeta^2}}|~~~~\Delta=2~or~5$

单位斜坡输入时$y=t-\frac{2\zeta}{\omega_n}+\frac{e^{-\zeta\omega_nt}}{\omega_n\sqrt{1-\zeta^2}}\sin{(\omega_dt+2\arctan{\frac{\sqrt{1-\zeta^2}}{\zeta}})}$

稳态误差$e_{ss}=\frac{2\zeta}{\omega_n}$

4. ζ<0，此时系统发散



### 二阶系统的改善

1. 误差的PD控制

![屏幕截图 2024-01-10 232253](D:\allProject\markdown\自控理论\屏幕截图 2024-01-10 232253.png)

如图在前向通道中引入比例-微分环节

$G_B(s)=\frac{\omega_n^2(1+T_ds)}{s^2+(2\zeta\omega_n+T_d\omega_n^2)s+\omega_n^2}$

特征根变为$s_1,s_2=-\zeta_d \omega_n\pm j\omega_n\sqrt{1-\zeta_d^2}~~~~\zeta_d=\zeta+\frac 12T_d\omega_n>\zeta为等效阻尼比$

可以看到闭环极点实部增加，虚部减小，减少了原系统的振荡性

2. 输出的微分反馈

   ![屏幕截图 2024-01-10 233609](D:\allProject\markdown\自控理论\屏幕截图 2024-01-10 233609.png)

$G_B(s)=\frac{\omega_n^2}{s^2+(2\zeta\omega_n+K_t\omega_n^2)s+\omega_n^2}~~~~\zeta_t=\zeta+\frac12K_t\omega_n>\zeta$

### 高阶系统分析

设$G_B(s)=\frac{\sum\limits_{j=0}^{m}b_{j}s^{j}}{\sum\limits_{i=0}^{n}a_{i}s^{i}}$

则在单位阶跃输入下$Y(s)=\frac{\sum\limits_{j=0}^{m}b_{j}s^{j}}{\sum\limits_{i=0}^{n}a_{i}s^{i}}\frac1{s}=\frac{K\prod\limits_{i=1}^m(s+z_i)}{\prod\limits_{j=1}^q(s+s_j)\prod\limits_{k=1}^r(s^2+2\zeta_k\omega_ks+\omega_k^2)}\frac1s$

其中q为实极点的个数，r为共轭复极点的个数，且q+r=n>m，设这些互异且均位于左半平面则

$Y(s)=\frac{A_0}s+\sum\limits_{j=1}^q\frac{A_j}{s+s_j}+\sum\limits_{k=1}^r\frac{B_ks+C_k}{s^2++2\zeta_k\omega_ks+\omega_k^2}~~~~0\textless\zeta_k\textless1$

其中$A_0=\lim\limits_{s\rightarrow0}Y(s)=\frac{b_0}{a_0}~~~~A_j=Res[Y(s),s_j]~~~~B_k,C_k为复极点处留数有关的常系数$

$y(t)=A_0+\sum\limits_{j=1}^qA_je^{-s_jt}+\sum\limits_{k=1}^r[B_ke^{-\zeta_k\omega_kt}\cos{\sqrt{1-\zeta_k^2}\omega_kt}+C_ke^{-\zeta_k\omega_kt}\sin{\sqrt{1-\zeta_k^2}\omega_kt}]$

稳定（收敛）条件为，所有极点的实部都是负的，且稳定输出为A~0~

可以看到高阶系统为多个一阶系统合二阶系统的响应和



对于闭环极点均位于左半平面的高阶系统，离虚轴远的极点相应的函数项衰减的快

各函数项系数取决于极点零点分布，若某极点远离原点，则系数小；若某对极-零点十分接近，同时又远离其他的极点零点，则系数也小，这对极-零点称为偶极子；若某极点远离零点又接近原点或其他极点，则系数大



高阶系统中，若存在一对共轭极点且满足

1. 周围没有零点且距离虚轴最近
2. 其他极点与虚轴距离比这一对极点离虚轴距离大3倍以上

则这对极点对应系数最大且衰减最慢，高阶系统的单位阶跃响应合动态性能主要由它来决定，这对极点称为闭环主导极点，满足主导极点条件的系统可近似成为二阶系统

### 稳定性与劳斯判据

+ 若线性系统在初始扰动作用下，其动态响应随时间衰减并趋于0，则称系统稳定

  稳定性仅与内部性质有关，与外作用无关

  如果满足$\lim\limits_{t\rightarrow\infty}y=\lim\limits_{t\rightarrow\infty}\dot y=...=\lim\limits_{t\rightarrow\infty}y^{(n-1)}=0$

  则系统稳定，对应特征方程为$\sum\limits_{i=0}^na_is^i=0$

  设上式存在k个实根λ~j~，r对共轭复根σ~i~+jω~i~，则在单位阶跃输入下$y=\sum\limits_{j=1}^kC_je^{\lambda_jt}+\sum\limits_{i=1}^re^{\sigma_it}(A_i\cos{\omega_it}+B_i\sin{\omega_it})$

若λ~i~<0,σ~i~<0,输出衰减，ω~i~不等于0时按振荡衰减，等于0时按指数衰减，均稳定

若实部不小于0，系统可能是临界的，此时仍然认为事不稳定的

+ 劳斯判据
  1. 必要条件，特征方程系数均为正实数
  2. 列写劳斯行列式表![图片4](D:\allProject\markdown\自控理论\图片4.png)

劳斯判据:若上述劳斯行列表中第一列所有元素均为正数，则特证方程的所有根的实部均在s平面的左边，此即为系统稳定的充要条件。若第一列中出现小于零的元素，系统就不稳定，且其符号变化的次数等于系统特征方程在s右半平面根的数目。

对于三阶系统，只要$a_1a_2>a_0a_3$则系统的所有特征根都有负实部；二阶系统系数为正一定稳定

劳斯判据只是给出系统是否稳定，不能衡量稳定的程度，特征根可能紧贴虚轴

为了解决这个问题，可以用新变量$s_1=s+a$代入原特征方程，使得所有的根向做平移以远离虚轴

+ 劳斯判据的特殊情况

  1. 某行第一个元素为0，其余不全为0

     此时使用一个很小的正数ε代替0，使得计算进行下去

  2. 出现全为0的一行

     使用前一行的系数构造辅助方程F（s）=0，并对s求导，用导数方程的系数代替这一行。辅助方程的系数通常为偶数次

### 稳态误差分析

​		误差e反映了系统在r和n作用下的响应，对高阶系统求解e比较困难，但求稳态误差e~ss~比较容易

$e_{ss}=\lim\limits_{t\rightarrow\infty}=\lim\limits_{t\rightarrow\infty}[L^{-1}(E(s))]$

当sE(s)在右半平面及虚轴（不包括原点）解析，全部极点位于左半平面，则由终值定理

$e_{ss}=\lim\limits_{s\rightarrow0}sE(s)$

稳态误差同时与系统内结构和外作用有关，并且无法反映随时间的变化；对于某些输入，例如正弦函数，不能使用终值定理

+ 输入信号作用下系统的类型和静态误差函数

  不考虑扰动情况下，输入信号作用下的系统的开环传递函数可以写成若干个典型环节串联

  $G(s)H(s)=\frac{K(\tau_1s+1)...(\tau_ms^2+2\zeta\tau_ms+1)}{s^{\gamma}(Ts+1)...(T_ns^2+2\zeta T_ns+1)}$

其中K为开环增益，γ为积分环节数目，则

$e_{ss}=\lim\limits_{s\rightarrow0}sE(s)=\lim\limits_{s\rightarrow0}s\frac1{1+G(s)H(s)}R(s)=\lim\limits_{s\rightarrow0}\frac{s^{\gamma+1}}{s^{\gamma}+K}R(s)$

1. 单位阶跃输入，0阶

   代入r得$e_{ss}==\lim\limits_{s\rightarrow0}\frac{s^{\gamma}}{s^{\gamma}+K}~~~\gamma=0,e_{ss}=\frac1{1+K}~~~\gamma\geq1,e_{ss}=0$

2. 单位斜坡输入，一阶

   代入r=t得$e_{ss}==\lim\limits_{s\rightarrow0}\frac{s^{\gamma-1}}{s^{\gamma}+K}~~~\gamma=0,e_{ss}=\infty~~~\gamma=1,e_{ss}=\frac1K~~~\gamma\geq2,e_{ss}=0$

3. 等加速度输入，二阶

   代入$r=\frac12t^2$得$e_{ss}=\lim\limits_{s\rightarrow0}\frac{s^{\gamma-2}}{s^{\gamma}+K}~~~\gamma\leq1,e_{ss}=\infty~~~\gamma=2,e_{ss}=\frac1K~~~\gamma\geq3,e_{ss}=0$

上述输入的阶数以积分环节个数γ计

对一个以上定义的n阶系统，设静态误差系数$K_x=\lim\limits_{s\rightarrow0}s^nG(s)H(s)=\lim\limits_{s\rightarrow0}\frac K{s^{\gamma}}$这个系数的大小反映了稳态精度，越大精度越高

+ 改善系统稳态精度的方法

  1. 增大开环增益，增大扰动作用点之前的增益可以降低扰动引起的误差

  2. 在前向通道增加积分环节，但可能对系统响应产生影响

  3. 采用复合控制，又称顺馈

     按扰动补偿，将扰动通过传递函数G~yn~作用在起始的综合点上，解出补偿条件为$G_{yn}=-\frac1{G_1}$

​			  按输入补偿，将输入通过另一条前向通道的传递函数G~R~作用在起始综合点上，补偿条件为$G_R=\frac1G$

## 根轨迹法

### 根轨迹与根轨迹方程

根轨迹为系统中某个参量从0变化到无穷大时，其闭环特征根在平面上的移动轨迹

根轨迹方程：满足$GH=-1$的所有根

写成零极点增益有$GH=\frac{K^*\prod\limits_{i=1}^m(s-z_i)}{\prod\limits_{j=1}^n(s-p_j)}=-1$

分离幅值和相角有$\frac{K^*\prod\limits_{i=1}^m|s-z_i|}{\prod\limits_{j=1}^n|s-p_j|}=1~~~~\sum\limits_{i=1}^m\angle (s-z_i)-\sum\limits_{j=1}^n\angle (s-p_j)=(2k+1)\pi~~~k\in Z$

其中K^*^称为根轨迹增益，与K成比例

### 绘制根轨迹的基本法则

1. 起点

   根轨迹开始于开环极点，且K^*^=0

2. 终点

   根轨迹终止于开环传递函数的零点（包括无穷远零点），且K^*^=∞，

3. 对称性

   各分支连续且关于实轴对称

4. 渐近线

   由于开环零点数m小于等于开环极点数n，则当K^*^趋于无穷时，有n-m条根轨迹趋向于无穷远，方位可由渐近线确定

   倾角：$\phi_a=\frac{(2k+1)\pi}{n-m}$

   实轴交点：$\sigma_a=\frac{\sum\limits_{j=1}^np_j-\sum\limits_{i=1}^mz_i}{n-m}$

5. 实轴上的根轨迹

   由于共轭复根的存在，这一对复根对实轴上的点的相角相互抵消，没有影响，则对于实轴上任意一点，只要该点右侧实数零点和极点的个数为奇数，该点就为根轨迹上一点

6. 出射角和入射角

   $\theta_{pk}=\sum\limits_{i=1}^m\angle(p_k-z_i)-\sum\limits_{j\neq k}^n\angle(p_k-p_j)-(2k+1)\pi$

   $\theta_{zk}=\sum\limits_{j=1}^n\angle(z_k-p_j)-\sum\limits_{i\neq k}^m\angle(z_k-z_i)+(2k+1)\pi$

   其中pk和zk是这条根轨迹的起始和终止点

7. 分离点和会合点

   一些情况下，两条根轨迹可能在实轴相遇然后向两侧伸向复平面，也可能从平面伸向实轴时相遇，然后分离向实轴两侧

   这些分离/会合点都对应了特征方程的一对重根

   设分离点为d，则$\sum\limits_{j=1}^n\frac1{d-p_j}=\sum\limits_{i=1}^m\frac1{d-z_i}$

   或者，设闭环特征方程为$f(s)=A(s)+K^*B(s)=0~~A,B不含K^*$

   则闭环重根（分离/会合点）由$AB'-A'B=0$给出，另外分离K^*^后求导得

   $\frac{dK^*}{ds}=\frac{AB'-A'B}{B^2}=0$也可以求

8. 虚轴的交点

   此时有s的实部为0，s=jω

   则$G(j\omega)H(j\omega)+1=0$,可求出与虚轴交点ω~c~。

   如果与虚轴有交点，意味着系统处于临界状态

9. 根之合

   闭环特征根之和等于常数，即随着K^*^变化，一些闭环极点沿着根轨迹向左运动，则必有另一些向右运动



根轨迹上任一点s对应的K为，从GH各极点到s的所有向量模长之积/从GH各零点到s的所有向量模长之积



另外需要指出的是，根轨迹只确定闭环极点，而系统的瞬态响应由极点合零点共同确定，即不同系统的根轨迹可能一样

### 闭环零极点分布与阶跃响应

n阶闭环传递函数$G_B(s)=\frac{K^*\prod\limits_{i=1}^m(s-z_i)}{\prod\limits_{j=1}^n(s-s_j)}$

z为闭环零点，一般可由公式求得，s为闭环极点，可由根轨迹求得

当输入为单位阶跃时，$Y(s)=\frac{K^*\prod\limits_{i=1}^m(s-z_i)}{\prod\limits_{j=1}^n(s-s_j)}\frac1s$

若G~B~无重根，则Y对应逆变换为$y=A_0+\sum\limits_{k=1}^nA_ke^{s_kt}$,其中

$A_0=G(0)~~~~A_k=\frac{K^*\prod\limits_{i=1}^m(s_k-z_i)}{s_k\prod\limits_{j=1}^n(s_k-p_j)}\Big|_{j\neq k}$

闭环零极点应满足如下定性关系

1. 各闭环极点实部为负
2. 闭环极点远离虚轴，且分布在和负实轴成45°角附近
3. 闭环极点间距大，零极点间距小，因为当一个零点靠近极点时，对应A~k~值小，响应分量影响就小；离虚轴最近的极点衰减慢，对控制起主要作用

闭环主导极点：离虚轴最近的闭环极点，一般其他极点实部比这个极点实部大2~3倍时，可以忽略其他极点作用

偶极子：当一个零点离极点较近时，它会削减该极点的作用，选取闭环主导极点时应将偶极子去除

有了闭环主导极点，高阶系统就可以近似为一阶或二阶系统分析

### 开环零极点变化对系统的影响

**具体分析！！！**

增加开环极点一般会使闭环动态性能变差，尤其对稳定性影响大

增加开环零点一般对增强稳定性和改善动态性能有利

开环极点越远离虚轴稳定性越好

开环极点虚部越大性能变差

开环零点越靠近虚轴作用越强对系统性能和稳定性越好

### 特殊根轨迹

+ 参数根轨迹

  不仅对K，对其他参数也可以画出根轨迹，首先求得以对应参数为开环根轨迹增益的等效开环传递函数，再依照规则画

+ 多回路根轨迹

  当系统有多个回路时：内回路开环零极点按规则绘制；内外回路零极点构成整个系统开环零极点，按单回路绘制闭环根轨迹；据此得到的闭环根轨迹能确定闭环极点分布，而闭环零点由系统闭环传递函数决定

+ 零度根轨迹

  当存在正反馈的内回路时，只需把规则里的2k+1换成2k

+ 非最小相位系统根轨迹

  当系统有在右半平面的开环零极点时，按前述规则绘制即可

+ 延迟系统根轨迹

  含有纯延迟环节$e^{-\tau s}$的称为延迟系统

  则其闭环特征根有无数个，当τ较小时可以对其展开成$\frac1{1+\tau s}~or~1-\tau s$，当τ较大时，令$s=\sigma+j\omega$

则有新的幅值和相角条件$e^{-\sigma\tau}\Big|\frac{\prod\limits_{i=1}^m(s-z_i)}{\prod\limits_{j=1}^n(s-p_j)}\Big|=\frac1{K_g}~~~\sum\limits_{j=1}^n\angle(s-p_j)-\sum\limits_{i=1}^m\angle(s-z_i)=(2k+1)\pi-\omega\tau$

当s变化时，它的实部会影响幅值，虚部会影响相角，此时绘制规则变为

1. 起点：K~g~=0，除开环零点z~i~，s实部为负无穷时也满足，即有无限个无穷远起点

2. 同理，无穷远终点也有无限个

3. 由上可知，根轨迹有无数条，仍关于实轴对称

4. 延迟环节对实轴上的根轨迹无作用，仍按前述规则

5. 分离/会合点变为：$A'Be^{-\tau s}-[e^{-\tau s}B]'A=0$

6. 由1.2. 渐近线为水平先，与虚轴交点为$\omega=\frac{n\pi}\tau~~~~n\in N$

7. 出射角与入射角$\theta_{pk}=\sum\limits_{i=1}^m\angle(p_k-z_i)-\sum\limits_{j\neq k}^n\angle(p_k-p_j)+(\pi-\omega\tau)~~~~~~\theta_{zk}=\sum\limits_{j=1}^n\angle(z_k-p_j)-\sum\limits_{i\neq k}^m\angle(z_k-z_i)+(\pi+\omega\tau)$

8. 根轨迹与虚轴交点：$\sum\limits_{j=1}^n\arctan\frac\omega{-p_j}-\sum\limits_{i=1}^m\frac\omega{-z_i}=(2k+1)\pi-\omega\tau$

   求得的无穷多个交点，取最靠近实轴的为主根轨迹与虚轴交点

多条根轨迹与虚轴相交时的开环根轨迹增益，取其中最小的作为临界增益，$K_{gc}=\Big|\frac{\prod\limits_{j=1}^n(j\omega'-p_j)}{\prod\limits_{i=1}^m(j\omega'-z_i)}\Big|$其中ω‘为最靠近实轴的根轨迹与虚轴交点

## 频率法
