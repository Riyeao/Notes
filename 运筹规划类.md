# 运筹规划类

## 线性规划

线性规划的数据模型由三个要素构成：决策变量、目标函数、约束条件，问题的目标函数是多个决策变量的**线性**函数，通常是求最大值或最小值；问题的约束条件是一组多个决策变量的**线性**不等式或等式

线性规划一般形式为
$$
\min_x \: c^T X \\

\begin{equation}
    s.t. \:
    \begin{cases}
        & Ax \leq b \\
        & A_{eq} \cdot x = b_{eq} \\
        & lb \leq x \leq ub
    \end{cases}
\end{equation}
$$
标准型为
$$
\max\: c^T X \\

\begin{equation}
    s.t. \:
    \begin{cases}
        & Ax = b \\
        
        & x\geq 0
    \end{cases}
\end{equation}\\
其中是求目标函数最大值，变量x非负，常数量b非负
$$
基：B是规划的一个基指B是A的一个满秩子方阵，B需要和A有相同行数

基解：B中每一个列向量称为基向量，令A中对应的非基向量全为0，则可以解出唯一解X，称为基解

凸集及其顶点：若一个集合C任意两点间连线也都是C中的点，则C为凸集，如果其中一个点在C中不存在两点使其成为两点连线上的点，则该点为C的顶点

![image-20230809170436319](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20230809170436319.png)

满足非负约束的基解称为基可行解

### 单纯形

线性规划问题的标准型是约束条件为等式，但有些存在不等式，这时就要引入松弛变量或剩余变量将其转化为等式，松弛变量等都是非负的，当遇到绝对值问题时也可以引入

单纯形法迭代的基本思路是：先找到一个初始的基可行解，判定其是否为最优解，如为否，则转换到相邻的基可行解，并使目标函数值不断增大，一直找到最优解为止



## 整数规划

整数规划即为线性规划中变量取整数，整数规划最优解不能按线性规划的最优解简单取整得到

![image-20230809170927920](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20230809170927920.png)

易知整数规划的可行解是线性规划解集中的整数点，有时通过寻找邻近点方法找到最优解，也可以使用启发式方法（特殊算法类）

### 分支定界算法

先求相应问题最优解

在解变量中任意找一个非整数量x~i~，添加约束条件x≥[x~i~]以及x≤[x~i~]+1，再次求解线性规划问题

重复此过程，直到找到或发现方法不可行

### 割平面算法

将每次模型含有最优解的部分子集用割线割去，同时使剩余集合仍包含整数规划所有的可行解，再次求解模型，直到最优解为整数解





一样先求线性规划最优解

之后将原模型转化为标准型，设加入了p个松弛变量s~k~

将等式约束求出一系列等式，要求每个等式只包含一个原始变量，其余全是松弛变量，且原始变量系数为1

每个等式可以写为$x_i+\sum w_{ik}s_k=b_i$

其中w为对应x~i~和s~k~的系数

再将w和b进行整数分解，令$f_i=b_i-[b_i],f_{ik}=w_{ik}-[w_{ik}]$

对原模型补充条件 $f_i-\sum f_{ik}s_k\leq 0$

再次求解模型，直到求得的最优解为整数解

### 匈牙利算法（指派问题）

基础问题：有m个工作，m个人，每人只能做一项工作，每个工作只能由一个人做，已知每个人干每个工作的代价，求最小代价

建立系数矩阵C，c~ij~表示第i个人做第j项工作的代价，以及指派矩阵X，x~ij~只能取0和1，表示是否指派第i个人做第j项工作，X的每行每列只能有一个1

则指派问题的模型为![image-20230809193222968](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20230809193222968.png)

非标准形式的指派问题

1. 最大化问题：代价变为效益，求最大效益，令$B=(m-c_{ij})_{n×n}$，m为C中最大值
2. 人数与工作不等：缺什么就添加虚拟的什么，向矩阵中添加0向量补成方阵
3. 一个人可以做多项工作：将这个人变成几个人，每人都只能做一项
4. 某工作一定不能由某人做，将对应代价取足够大

匈牙利算法步骤（极其抽象！！！）： 

![image-20230809200458768](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20230809200458768.png)

## 非线性规划

一般形式
$$
\min_x \: f(x)\\

\begin{equation}
    s.t. \:
    \begin{cases}
        & Ax \leq b \\
        & A_{eq} \cdot x = b_{eq} \\
        & c(x)\leq 0\\
        & c_{eq}(x)=0\\
        & lb \leq x \leq ub
    \end{cases}
\end{equation}
$$
c表示非线性向量函数约束条件

简单非线性函数线性化

[绝对值，分段，双重maxmin，分式，约束存在或关系]([干货 | 令人拍案叫绝的线性化方法/技巧 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/552076713))

非线性规划当函数本身不含线性成分时，使用代码吧

拉格朗日法：借鉴高数的求极值问题，设非线性规划模型为

![image-20230809224529467](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20230809224529467.png)

​	定义拉格朗日函数	![image-20230809224607827](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20230809224607827.png)		

其极值位于各偏导等于0的点

注意这里当解在g内部，不等式约束实际无效，当解在g上，不等式约束转化为等式约束，由此有kkt条件

![image-20230809225753940](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20230809225753940.png)

[其他解法]([【数学建模】数学建模学习3---非线性规划（例题+matlab代码实现）_matlab非线性规划例题_小天才才的博客-CSDN博客](https://blog.csdn.net/qq_44528283/article/details/117400926))

## 多目标规划

要求对多个函数进行规划，找到最优值

通常方法有：

1. 线性加权法：添加约束权重和等于1
2. 均方加权法：同上![image-20230809231234629](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20230809231234629.png)
3. 重要度法：将函数分重要程度，先解出重要度高的最优解，在原约束条件下添加重要度高函数达到最优解作为约束继续解模型
4. 理想点法：先解出每个目标的理想解，然后以到所有解距离最小的解作为目标函数

![image-20230809231212466](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20230809231212466.png)

5. [约束法]([【多目标规划问题求解】ε-约束算法_epsilon约束法_雾雨霜星的博客-CSDN博客](https://blog.csdn.net/weixin_44786238/article/details/126068290))

6. 功效系数法：对每个目标构造一个功效函数反应逼近其最优目标的程度
   $$
   记maxf_i(x)=M_i,minf_i(x)=m_i\\
   功效函数d_i=\begin{equation}
        \:
       \begin{cases}
           & 1 &f_i(x)=M_i\\
           & 0 &f_i(x)=m_i \\
           & \frac{M_i-f_i(x)}{M_i-m_i} &m_i\textless f_i(x)\textless M_i\\
       \end{cases}
   \end{equation}\\
   定义目标函数：max\prod\limits_{i=1}^nd_i
   $$

7. 最大最小化模型：一种保守策略，即确保最小收益最大化，找出失败的最大可能性中的最小值，例如急救中心选址问题

   目标函数为$min\{maxf_1(x),maxf_2(x),...f_n(x)\}$

   

## 动态规划

通过拆分问题，将问题拆分成许多的子问题，定义问题状态和状态之间的关系（即状态转移方程或递推公式），使得问题能够以递推（或者说分治）的方式去解决。按顺序求解子问题，前一子问题的解，为后一子问题的求解提供了有用的信息，在求解任一子问题时，列出各种可能的局部解，通过决策保留那些有可能达到最优的局部解，丢弃其他局部解。依次解决各子问题


动态规划通过自底向上的顺序，确定问题的子问题，寻找子问题的最优解来构成自身最优解

首先确定各个阶段问题的子结构，建立状态转移方程，即父问题是由几个子问题通过何种决策产生的，根据上一阶段状态和决策导出本阶段的状态；然后寻找边界条件，即这种方法到哪一步能停止，通常是不具备子问题的最简单问题。

在这个过程中，要建立备忘录，记录重复出现的子问题的解，在再次遇见时直接调用
$$
令S_k为第k阶段状态变量，U_k(S_k)为决策变量，D_k为该阶段允许决策集合\\
各阶段决策确定后，整个问题的决策构成决策序列P_{k,n}=\{U_1,U_2,...,U_n\}\\
指标函数V_{k,n}(S_k,P_{k,n})表示从k到n阶段，初始状态为S_k,决策序列为P_{k.n}的后序子过程的指标函数值\\
最优指标函数f_k(S_k)=opt V_{k,n},即从k到n采取最优决策序列到过程终止时的最优指标函数，其中opt取min或max\\
DP逆序解法的基本方程f_k(S_k)=opt\{V_k(S_k,U_k+f_{k+1}(S_{k+1})\}\\
边界条件为f_{n+1}(S_{n+1})=0
$$


适用情况： 无后效性：某阶段之后的决策不会影响当前情况

​					最优子结构：最优解一定由子问题的最优解推导得出

​					重叠子问题：不同的情况有相同的子问题

[连续性动规](https://zhuanlan.zhihu.com/p/369190152)