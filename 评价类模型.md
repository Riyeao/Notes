# 评价类模型（协方差分析在学了回归分析后再整）

## 层次分析法

### 建立层次结构模型

将决策的目标、考虑的因素(决策准则)和决策对象按他们之间的相互关系分成最高层、中间层和最低层，绘制层次结构图。

- 最高层（目标层）：决策的目的、要解决的问题

- 中间层（准则层或指标层）：考虑的因素、决策的准则、指标等

- 最低层（方案层）：决策的方案



###  构造判断（成对比较）矩阵

| 标度       | 含义                                                         |
| ---------- | ------------------------------------------------------------ |
| 1          | 表示两个因素相比，具有同样重要性                             |
| 3          | 表示两个因素相比，一个因素比另一个因素稍微重要               |
| 5          | 表示两个因素相比，一个因素比另一个因素明显重要               |
| 7          | 表示两个因素相比，一个因素比另一个因素强烈重要               |
| 9          | 表示两个因素相比，一个因素比另一个因素极端重要               |
| 2，4，6，8 | 上述两相邻判断的中值                                         |
| 倒数       | 若因素 i 与 因素 j 比较判断的结果是 $a_{ij}$ ，则因素 j 与 i 的比较结果是 $a_{ji}=\dfrac{1}{a_{ij}}$ |

根据表中的判断标准即可绘制一个对比矩阵（将列元素作为被比较者）

但是，根据主观判断两两比较得出的比较矩阵可能存在冲突，需要经过一致性检验判断是否合理

### 一致性检验

计算一致性比例 CR

- $CR=\dfrac{CI}{RI}$ ，其中 $CI=\dfrac{\lambda_{max}-n}{n-1}$ ，其中 $\lambda_{max}$ 为对比矩阵的最大特征值，$n$ 为指标数（即判断矩阵的行数）
- $RI$ 为平均随机一致性指标，通过查表可得

|  n   |  1   |  2   |  3   |  4   |  5   |  6   |  7   |  8   |  9   |  10  |
| :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| $RI$ |  0   |  0   | 0.52 | 0.89 | 1.12 | 1.26 | 1.36 | 1.41 | 1.46 | 1.49 |

如果求出的 $CR$ 比某个非常小的数要小，比如 0.1 ，那么该判断矩阵通过了一致性检验，**否则需要调整矩阵中的元素重新计算**

###  计算权重

将通过检验的矩阵归一化处理

权重计算方法有很多，常用的有算术平均法，集合平均法，特征值法

算数平均：权重向量$w_i=\frac1n\sum_{j=1}^n\frac{a_{ij}}{\sum_{k=1}^na_{kj}}$

几何平均：$ w_i=\frac{(\prod_\limits{j=1}^na_{ij})^{\frac1n}}{\sum_\limits{k=1}^n(\prod_\limits{j=1}^na_{kj})\frac1n} $

特征值法：类似一致矩阵取权重，为近似。对判断矩阵求最大特征值的特征向量并归一化就是权重

最后对所有准则进行加权求和，得到综合评分进行排名（进行加权的数据需要经过归一化处理）

### 注意

- 构造判断矩阵时常常是自己给出数据，使得最后结果较为主观
- 由于平均随机一致性指标***RI***最多到15，进行比较的权重不宜过多，越多判断矩阵离一致矩阵差异越大
- 鉴于有时不同方案对某因素的敏感程度不同，可以对所有方案对每个因素的响应均求一次权值

## 熵权法

### 熵的概念

- 信息论中，熵是对不确定性的一种度量，可以判断一个事件的**随机性和无序程度**
- 用熵值可以判断某个指标的离散程度，指标的离散程度越大，该指标对综合评价的影响越大

实际举例可为：某一门课 「不易拉开差距」，意味着这一门课对最终成绩影响很小，**相应混乱程度就低**，评价总成绩是可以给该门课**赋予低权重**

###  具体步骤

**第一步**，先将指标进行归一化处理（一共 n 个样本，m 个指标，$x_{ij}$ 为第 i 个样本的第 j 个指标的数值）：

- 正向指标（指标越大越好）：

$$
X_{ij}=\dfrac{x_{ij}-\min\{x_{1j},\ldots,x_{nj}\}}{\max\{x_{1j},\ldots,x_{nj}\}-\min\{x_{1j},\ldots,x_{nj}\}}
$$

- 负向指标（指标越小越好）：

$$
X_{ij}=\dfrac{\max\{x_{1j},\ldots,x_{nj}\}-x_{ij}}{\max\{x_{1j},\ldots,x_{nj}\}-\min\{x_{1j},\ldots,x_{nj}\}}
$$

- 进行比重计算：

$$
p_{ij}=\dfrac{X_{ij}}{\sum\limits_{i=1}^nX_{ij}}
$$

**第二步**，计算第 j 项指标的熵值
$$
e_j=-k\sum_{i=1}^np_{ij}\ln(p_{ij})
$$
其中 $k=\dfrac{1}{\ln n}>0$ ，所以满足 $e_j \ge 0$ ，如此计算出信息熵冗余度 $d_j=1-e_j$

**第三步**，计算各指标的权重 $w_j$，并由此得出各样本的综合得分 $S_i$

其中权重 $w_j$ 的计算方法：
$$
w_j=\dfrac{d_j}{\sum\limits_{j=1}^m d_j}
$$

### 注意

- 熵权法是**根据数据本身建立评价体系**，完全客观，追求公平公正。
- 该方法适用于只有数据没有说明各因素的重要程度时，或缺乏评价的文献资料以及文献资料说法不一时。
- 熵权法也有缺点。比如，在调查各个地区水质时，某地区含氧量指标更重要，而另一地区 PH 值更重要，这时便不太适合用熵权法进行评价。

## TOPSIS法（优劣解距离）

###  数据预处理

- **指标正向化**

在处理数据时，有些指标的数据越大越好，有些则是越小越好，有些又是中间某个值或某段区间最好。

此时我们可以对其进行 「正向化处理」，使指标都可以项考试分数一样越大越好。

1. 极小型与极大型：如同上文的正向负向指标一样，采用 min-max 规约
2. 区间型：

$$
\widehat{x_i}=\begin{cases}
1-\dfrac{a-x_i}{M},\quad x_i<a \\
1, \quad a<x_i<b \\
1-\dfrac{x_i-b}{M}, \quad x_i>b
\end{cases}
$$

3. 中间型：

$$
\widehat{x_i}=1-\dfrac{x_i-x_{best}}{M}
$$

其中，式中出现的 M 为数据端点值与 **中间值\区间端点** 的最大距离

- **指标无量纲化**

向量归一化（比重化）：$z_{ij}=\frac{x_{ij}}{\sqrt{\sum\limits_{i=1}^nx_{ij}^2}} $

z-score（标准化）: $z=\frac{x-\mu(x)}{\sigma(x)}$  

### 求解最佳样本

**第一步**，求出预处理后数据的正理想解（集合了所有指标数据中的最优值）和负理想解（集合了所有指标数据中的最差值）

**第二步**，将样本数据看作是在 n 维平面上的点，求出各点到正理想解与负理想解间的距离 $d_i^+,d_i^-$，求出相对贴近度 $f_i=\frac{d_i^-}{d_i^++d_i^-}$ ，比较各方案 f 大小，越大说明离正理想解越近，离负理想解越远

### 注意

- 某些方法将指标处理时不一定全部处理为正向数据，但是负向数据仍为负向

## CRITIC法

该方法是一种**比熵权法和标准离差法更好的客观赋权法**。它是基于评价指标的对比强度和指标之间的冲突性来综合衡量指标的客观权重。 考虑指标变异性大小的同时兼顾指标之间的相关性，并非数字越大就说明越重要，完全利用数据自身的客观属性进行科学评价。

### 数据正向化与标准化

具体操作与前文一致，这里不加赘述（m 个待评对象，n 个评价指标，构成数据矩阵 $X=(x_{ij})_{m \times n}$ )

### 计算信息承载量

在这之前先计算两个中间量：对比度和矛盾性

1. 对比性（实质上就是标准差）

$$
\sigma_j=\sqrt{\dfrac{\sum\limits_{i=1}^m(x_{ij}-\overline{x_j})}{m-1}}
$$

2. 矛盾性：反映的是不同指标间的相关程度

$$
f_j=\sum_{i=1}^m(1-r_{ij})
$$

	其中 $r_{ij}$ 表示指标 i 与指标 j 之间的相关系数（皮尔逊相关系数）
$$
r = \dfrac{\sum\limits_{i=1}^n(X_i-\overline{X})(Y_i-\overline{Y})}{\sqrt{\sum\limits_{i=1}^n(X_i-\overline{X})^2}\sqrt{\sum\limits_{i=1}^n(Y_i-\overline{Y})^2}}
$$

3. 信息承载量 $C_j=\sigma_jf_j$

### 计算权重

$$
w_j=\dfrac{C_j}{\sum\limits_{j=1}^nC_j}
$$

### 注意

- 适用于数据间具有一定相关性的数据，数据的稳定性作为必须要考虑的信息

## 模糊综合评价法

多因素问题的评价决策比较困难，因为要同时综合考虑的因素很多，而各因素重要程度又不同，使问题变得很复杂。如果用常规经典数学方法来解决综合评价问题，就显得很困难。模糊数学则为解决模糊综合评价问题提供了理论依据，从而找到了一种简便而有效的评价与决策方法。通过模糊数学提供的方法进行运算，得出定量的综合评价结果，从而为正确决策提供依据，从而找到一种简便而有效的评价与决策方法。

### 建立评语集，确定因素权值

对每一个影响结果的因素建立一个评语集合**V**，例如{好，一般，差}使用某种赋权法得到各因素的权值向量w

### 建立评价矩阵

  通过对数据大致的二维图形走向确定一个隶属函数

  常见的隶属函数

![](https://pic4.zhimg.com/80/v2-e8be58207e10bd46a3672bab3771757b_720w.webp)

​		![](https://pic3.zhimg.com/80/v2-3fdde7a46f2d6a0d350ffce37025f16a_720w.webp)

​			![](https://pic3.zhimg.com/80/v2-33e7c5a4bab7d33a68ba85922b5f6986_720w.webp)

​		![](https://pic4.zhimg.com/80/v2-f2662473f83aef2f7f911ffca742ff2f_720w.webp)	

​	根据确定的隶属函数建立评价矩阵

​	$R=(r_{ij})_{n×m}$

​	r~ij~为第i个因素对评语集中第j个评语的隶属度，由隶属函数得出

### 得出并分析评价结果

$B=[b_1,b_2,...,b_m]$

其中B=w·R（这里的 · 是一种逻辑乘法算子）

常见算子

![](https://pic3.zhimg.com/80/v2-1945a551ecc096ccbf857935e7218e46_720w.webp)

​		![](https://pic1.zhimg.com/80/v2-b42b1900cd8613049b3852b1726075b0_720w.webp)

​		![](https://pic1.zhimg.com/80/v2-6bca665f511e25a5e1bc3a73f5933ab4_720w.webp)

​		**主因素突出型**和**加权平均型**在有些情况下得到的结果会与实际相悖，可以使用**主因素决定型（Zadeh的合成算法）**，但有些时候也会得到有些元素相同，使得结果失去效果，在这种情况下可以应用**最小隶属度加权平均偏差法**来解决。



对于得到的模糊评价向量 B （可以进行归一化处理），若评语集给出了相应的分数，则加权平均，反之遵循最大隶属原则

最大隶属原则：B对应的评价结果为其中最大值隶属的评语

加权平均原则：给出各个评语等级的分数后计算

​							分数= $\frac{\sum\limits_{i=1}^nw_ib_i}{\sum\limits_{i=1}^nb_i}$

​						   该分数更贴近哪个评语则最后评价结果就为该评语

​		当对比多个方案时

​			对每个方案得到的综合评价向量B都进行归一化处理，哪个最优评价的数值最高哪个方案最优

## 主成分分析法

用于降维的一种方法，当多个变量间存在关联时，可以用新的包含了原有的多个变量大部分信息的变量代替原有变量（主成分），从而使得需要处理的变量个数减少。

### 数据预处理和可行性检验

首先将数据标准化，并求出相关系数矩阵**R**

KMO检验法：计算各数据间偏相关系数
$$
偏相关系数是指在控制了某些变量后得到的另外两个变量的相关性，一阶偏相关系数:\\
r_{ij·h}=\frac{r_{ij}-r_{ih}r_{jh}}{\sqrt{(1-r_{ih}^2)(1-r_{jh}^2)}}\\公式左侧表示控制了h后计算ij的相关性\\
假设H_n表示n个被控制变量集合h_1，h_2...h_n，H_{n-1}表示去掉第n个变量后的集合，则高阶偏相关系数:\\
r_{ij·H_n}=\frac{r_{ij·H_{n-1}}-r_{ih_n·H_{n-1}}r_{jh_n·H_{n-1}}}{\sqrt{(1-r_{ih_n·H_{n-1}}^2)(1-r_{jh_n·H_{n-1}}^2)}}
$$
$KMO=\frac{\sum\sum_{i\neq j}r_{ij}^2}{\sum\sum_{i\neq j}r_{ij}^2+\sum\sum_{i\neq j}r_{ij·1,2,...k}^2}$

KMO越接近1，原数据越适合使用主成分分析，一般大于0.5即可

Bartlett检验法：越小越好。一般0.01

以上两种检验均可用SPSS计算

### 提取主成分

主成分向量 F=A^T^X 是原有变量的线性组合，每个主成分的线性组合系数需要规范化，且各个主成分间正交（不相关）

寻找X的线性组合F使得F的方差最大

方法：建立原数据协方差矩阵$\sum$（原数据标准化后和相关矩阵相等）

​			计算协方差矩阵的特征值，按从大到小排序，依次使用特征值对应的特征向量作为一个主成分的线性组合系数，分别称为第一主成分，第二主成分...特征值越大代表主成分越能涵盖原有变量（最好对主成分代表的实际意义作出恰当的模糊描述）

​			按序提取p个主成分直到累计贡献率 $\frac{\sum\limits_{i=1}^p\lambda_i}{\sum\limits_{i=1}^n\lambda_i}$ 达到某值（80％，85％，90％均可）或者提取至最后提取的特征值大于1，此时所有主成分可以很好的涵盖原有数据

## 灰色关联分析

灰色关联度分析（Grey Relation Analysis，GRA），是一种多因素统计分析的方法。简单来讲，就是在一个**灰色系统（我们只对该系统有部分了解）**中，我们想要了解其中某个我们所关注的某个项目受其他的因素影响的相对强弱，再直白一点，就是说：我们假设以及知道某一个指标可能是与其他的某几个因素**相关**的，那么我们想知道这个指标与其他哪个因素相对来说更有关系，而哪个因素相对关系弱一点，依次类推，把这些因素排个**序**，得到一个**分析**结果，我们就可以知道我们关注的这个指标，与因素中的哪些更相关，**即某一个项目在受到其他因素的影响的情况下，分析各个因素对它的影响程度**

可以避免回归分析，方差分析，主成分分析等需要大量数据的方法

### 确定参考序列和比较数据序列

直接建立矩阵$(X_0,X_1,X_2...,X_n)=(x_i(j))_{m×(n+1)}$   $i=0,1,2...n$    $j=1,2,...,m$

其中m为指标数，n为样例数，X~0~为参考序列，评价指标对方案的影响时是样本数据中每个指标的最优值或最劣值，评价其他指标对某指标数据影响时使用该组数据

### 计算关联系数

将除参考序列外所有序列计算${|x_0(k)-x_i(k)|}$ ，并找出两极最小差和两极最大差

$min=\mathop{\mathrm{min}}\limits_{i=1}^n\mathop{\mathrm{min}}\limits_{k=1}^m{{|x_0(k)-x_i(k)|}}$

$max=\mathop{\mathrm{max}}\limits_{i=1}^n\mathop{\mathrm{max}}\limits_{k=1}^m{{|x_0(k)-x_i(k)|}}$

计算每个比较序列（样例）的各指标与参考序列的关联系数：$\zeta_i(k)=\frac{min+\rho max}{{|x_0(k)-x_i(k)|}=\rho max}$

ρ是分辨系数，取0到1，ρ越小关联系数间差异越大区分能力越强，一般取0.5

当参考序列为最优序列时，关联系数越大越好，反之越小越好

### 计算关联度

关联度$r_{0i}=\frac1m\sum\limits_{k=1}^m\zeta_i(k)$反映各评价对象与参考序列的关联关系

如果各指标在评价中作用不同，上式写为加权形式$r_{0i}=\frac1m\sum\limits_{k=1}^mw_k\zeta_i(k)$

依据关联度排序得出综合评价结果

## 秩和比

秩和比（RSR）指在多指标综合评价中，表中各评价对象 n 秩次的相对平均值（若评价指标权重不同，则需要指标乘以权重），是一个非参数计量，具有0-1区间连续变量的特征。其基本思想是在一个 n 行（n 评价对象）p 列（p 个评价指标）矩阵中，通过秩转换，获得无量纲的统计量RSR，以RSR值对评价对象的优劣进行排序或分档排序。在综合评价中，秩和比的值能够包含所有评价指标的信息，显示出这些评价指标的综合水平，**RSR值越大表明综合评价越优**。
**优点：**因为 RSR 只使用了数据的相对大小关系，而不真正运用数值本身，所以此方法综合性强，可以显示微小变动，对离群值不敏感；能够对各个评价对象进行排序分档，找出优劣，是做比较，找关系的有效手段；能够找出评价指标是否有独立性。
**缺点：**通过秩替代原始指标值，会损失部分信息；不容易对各个指标进行恰当的编秩。

### 计算秩值

将每一个原指标按照指标值大小进行排序得到秩次r~ij~，用秩次代替原来的评价指标，建立秩次矩阵R~n×m~，n个对象，m个指标

秩次编制方法：

​	整秩法：高优指标从小到大编秩，低优指标从大到小编秩，同一指标数据相同者取平均值

​	非整秩法：

​			对于高优指标：$r_{ij}=1+(n-1)\frac{x_{ij}-x_{min}}{x_{max}-x_{min}}$

​			对于低优指标：$r_{ij}=1+(n-1)\frac{x_{max}-x_{ij}}{x_{max}-x_{min}}$

​	一般使用整秩法

### 计算秩和比RSR

$RSR_i=\frac1{nm}\sum\limits_{j=1}^m r_{ij}$

若各指标权重不同，计算加权秩和比$WRSR_i=\frac1{nm}\sum\limits_{j=1}^mw_jr_{ij}$

这一步进行完可以直接按照秩和比大小排名，或者继续下述的分档排序方法

### 建立RSR和概率单位的回归方程

首先确定RSR分布

​	将RSR值按照从小到大的顺序排列
​	列出各组频数
​	计算各组累计频数
​	确定各组RSR的秩次R及平均秩次 $\bar{R} $

​	计算向下累计频率 $ \bar{R}/n\ \times 100\% $，最后一项用 $ \left( 1-1/4n \right) \times 100\%$ 修正

​	根据累计频率，查询“百分数与概率单位对照表”，求其所对应概率单位 Probit 值

​	例如原数据RSR有 0.1000 0.4000 0.4000 0.5000 0.5667 0.6000 0.6667 0.7667 0.9000

​	则得到下图

​	![](https://img-blog.csdnimg.cn/20200616193842434.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMzc0Njk3,size_16,color_FFFFFF,t_70#pic_center)

其中[百分率和概率单位对照表](http://www.docin.com/p-2211225521.html)如链接

接下来计算回归方程：$R\hat SR=a+bProbit$

### 分档排序及分档合理性检验

利用上一步的回归方程，自行确定分档数量和分档线，一般从概率上分档并求出对应概率单位和RSR

接着对分档的合理性检验，一般使用方差一致性检验（Bartlett检验）或进行方差分析（F检验）等

## 数据包络分析

用于评价具有相同类型的多输入多输出系统的相对有效性（效率）

有两种基本类型：以投入为导向的CCR，即假设产出效率不变，得到最小输入

​							   以产出为导向的BCC，即假设投入不变，得到最大产出

其中，CCR分析综合效率（STE），BCC分析纯技术效率（PTE），关系为STE=PTE×SE，SE是规模效率

### CCR模型建立

假设有n个决策单元，m个投入，s个产出

记投入为x~ij~，产出为y~rj~，投入权系数为v~i~，产出权系数为u~r~，其中权重为未知量

建立综合评价指数$z_j=\frac{\sum_{r=1}^su_ry_{rj}}{\sum_{i=1}^mv_ix_{ij}}$

每一个决策单元都需要建立一个模型进行单独评价。以第j~0~个决策单元的效率评价指数最大化为目标函数，所有决策单元的效率评价指数不超过1为约束条件（效率不超过100%），可以构造第j~0~个决策单元的CCR模型，这是一个分式规划模型:
$$
\begin{gathered}
\max z_{j_0}=\frac{\sum_{r=1}^s u_r y_{r j_0}}{\sum_{i=1}^m v_i x_{i j_0}} \\
\left\{\begin{array}{c}
\frac{\sum_{r=1}^s u_r y_{r j}}{\sum_{i=1}^m v_i x_{i j}} \leq 1 \quad j=1,2, \cdots, n \\
v_i, u_r \geq 0, \quad i=1, \cdots, m ; r=1, \cdots, s
\end{array}\right.
\end{gathered}
$$
利用Charnes—Cooper变换：$t=\frac{1}{\sum_{i=1}^m v_i x_{i j}}, \quad \mu_r=t u_r, \quad \omega_i=t v_i$

转化为
$$
\max z_{j_0}=\sum_{r=1}^s \mu_r y_{r j_0} \quad \text { 约束条件 }\left\{\begin{array}{c}
\sum_{r=1}^s \mu_r y_{r j}-\sum_{i=1}^m \omega_i x_{i j} \leq 0 \quad j=1,2, \cdots, n \\
\sum_{i=1}^m \omega_i x_{i j_0}=1 \\
\mu_r, \omega_i \geq 0, \quad i=1, \cdots, m ; r=1, \cdots, s
\end{array}\right.
$$
上述模型的***对偶规划***中
$$
\begin{gathered}
\min S T E_{j_0} \\
\text { s.t. }\left\{\begin{array}{c}
\sum_{j=1}^n \lambda_j x_{i j} \leq S T E_{j_0} x_{i j_0} (i=1, \ldots, m) \\
\sum_{j=1}^n \lambda_j y_{r j} \leq y_{r j_0} (r=1, \ldots, s) \\
\lambda_{j \geq 0} \quad j=1, \ldots, n
\end{array}\right.
\end{gathered}
$$
还可以引入松弛变量s^+^,s^-^,松弛变量表示达到最优配置需要减少的投入量，剩余变量表示达到最优配置需要增加的产出量（$STE=\theta$）
$$
\begin{gathered}
\min \theta \\
\text { s.t. } \sum_{j=1}^n \lambda_j y_j+s^{+}=\theta x_0 \\
\sum_{j=1}^n \lambda_j y_j-s^{-}= y_0 \\
\lambda_j \geq 0, j=1,2, \ldots n \\
s^{+} \geq 0, s^{-} \leq 0
\end{gathered}
$$

1. 若满足 $\theta^*=1$ 且 $s^{*+}=0, s^{*-}=0$ ，则决策单元为 DEA 有效，决策单元的经济活动同时为 技术有效和规模有效;
2. 若满足 $\theta^*=1$ ，但至少某个投入或者产出大于 0 ，则决策单元为弱 DEA 有效，决策单元的经 济活动不是同时为技术有效和规模有效;
3. 若满足 $\theta^*<1$ ，决策单元不是 DEA 有效，经济活动既不是技术有效，也不是规模有效。

#### BCC模型

将上述问题中最后一个线性规划添加条件$\sum\lambda_j=1$即可变为BCC模型

我们可以对数据同时做 CCR 模型和 BCC 模型的 DEA 分析来评判决策单元的规模效率 (SE)。如果决策单元 CCR 和 BCC 的技术效益存在差异，则表明此决策单元规模无效，并且规模无效效率可以由 BCC 模型的技术效益和 CCR 模型的技术效益之间的差异计算出来。

### 其他

- [DEA问题计算软件DEAp下载]([Software - School of Economics - University of Queensland (uq.edu.au)](https://economics.uq.edu.au/cepa/software))

- 上述方法只能确定决策是否有效（达到理想生产曲线），更多关于数据解读，方案优化需要另找文献

## 方差分析

主要检验三个及以上样本的样本均值的显著性差异，使用方差分析有三个前提

1. 每个样本中个体相互独立
2. 每个样本值付出正态分布
3. 每个样本的方差相同

### **单因素方差分析**

设有k组样本，每组n个独立样本，i表示每组第几个样本，j表示第几组

定义
$$
零假设H_0:\mu_1=\mu_2=...=\mu_k  \\
备择假设H_1:样本均值不完全相等
$$
计算每组均值$\bar x_j$，每组方差$s_j^2$吗，总体均值$\mu=\frac{\sum_{j=i}^k\bar x_j}{k}$

计算组间估计：$MSA=\frac{n\sum_{j=1}^k(\bar x_j-\mu)^2}{k-1}$

​		组内估计：$MSE=\frac{\sum_{j=1}^k(n-1)s_j^2}{n-k}$

如果零假设为真，总体方差的组间估计和组内估计的比值，服从分子自由度为 k-1 ，分母自由度为n-k 的F分布$F=\frac{MSA}{MSE}$

当$F\textgreater {F_{\alpha}(k-1,n-1)}$时，拒绝H~0~

### **两因素方差分析**

如果多个总体由两个因素影响，需要用到两因素方差分析，就是在方差分析中需要考虑两个因素对因变量结果的影响，两因素方差分析有两种类型：1、有交互作用的方差分析：两个因素对因变量都有影响，同时还有两因素同时存在时，共同对因变量产生的影响。2、无交互作用的方差分析：两个因素对因变量的影响是独立的，不存在对因变量的共同影响。进行无交互作用的方差分析，一般是在完成有交互作用方差分析之后，当检验结果证明交互作用不显著时，就可以不考虑这个影响，重新进行无交互作用的方差分析

对有交互作用方差分析

零假设： 对A因素，H~0~为均值相等

​				对B因素，H~0~为均值相等

​				对AB交互因素，H~0~为不存在相互交互作用

假设有r组A因素样本，c组B因素样本

各均值计算

![](https://pic1.zhimg.com/80/v2-853787077ad9d438d541140b008ef430_720w.webp)

各离差平方和计算

![](https://pic3.zhimg.com/80/v2-217e8edaff817464837e0047eef27e26_720w.webp)

构造检验的F统计量，当
$$
F_A=\frac{\frac{SSA}{r-1}}{\frac{SSE}{rc(n-1)}}\textgreater{F_{\alpha}(r-1,rc(n-1))} \\
F_B=\frac{\frac{SSB}{c-1}}{\frac{SSE}{rc(n-1)}}\textgreater{F_{\alpha}(c-1,rc(n-1))} \\
F_A=\frac{\frac{SSAB}{(r-1)(c-1)}}{\frac{SSE}{rc(n-1)}}\textgreater{F_{\alpha}((r-1)(c-1),rc(n-1))} \\
$$


分别拒绝自身H~0~

![](https://pic3.zhimg.com/80/v2-ff17e4de761fdf31db4257f059589216_720w.webp)



