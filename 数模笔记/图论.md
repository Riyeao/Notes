# 图论

## 图的相关概念

- 图是一个二元组**G(V,E)** , 其中**V**为顶点集,**E**为边集, **E**中元素为元素对(v~i~,v~j~), 其中的元素用e表示, 为连接两顶点的边, 若元素对无序, 则图为无向图, 若有序, 则图为有向图, 此时顶点v~i~ 为边的尾, 顶点v~j~ 为头, 边称为有向边或弧

- **G**的阶为顶点的数目

- 边与它的两个端点称为相互关联, 这两个端点称为相邻顶点

- 端点重合的边称为环, 两顶点间存在多条边时称为重边

- 没有环和重边的图称为简单图. 如果**G**是简单图, 且

  

  任意两顶点都相邻的图称为完全图, 记为**K~n~**

  

  若顶点集可以被划分为k部分, 各部分内部的顶点间不相邻 , 称为k部图, 如果顶点均与其他部分中所有点相邻, 称为完全k部图

- 若给图的每条边赋值一个实数 w(e~i~), 称其为 e~i~ 的权, 称图为赋权图
- 如果一个图的顶点集和边集均为另一个图的子集, 则该图是另一个图的子图
- 由一系列彼此相邻的顶点所关联的边组成的序列称为**链或路**, 若链首尾相接称为圈(这里的圈允许出现重复顶点,有地方的圈除了首尾不允许出现重复顶点),链的一部分称为节,不含重复顶点的链称为迹或简单链
- 如果两顶点间存在链, 则称两顶点连通, 两顶点之间的距离被定义为连通顶点的最短链的长度
- 一个顶点的度d(v~i~)等于与其关联的边的数量, 当图为有向图时, 以该顶点作为尾的边的个数为出度, 记为d^+^(v~i~), 作为头的边的个数称为入度, 记为d^-^(v~i~); 对简单图 $\sum_{i=1}^{|V|} d\left(V_i\right)=2|E|$ .

## 图的矩阵表示

假设研究的图都是简单图

- 邻接矩阵: $a_{i j}= \begin{cases}1 & \left(v_i, v_j\right) \in E \\ 0 & \left(v_i, v_j\right) \notin E\end{cases}$    对无向图和有向图均成立,只需要令元素对为无序和有序即可

  对有向赋权图  $a_{i j}= \begin{cases}w_{i j} & \left(v_i, v_j\right) \in E \\ 0 & i=j\\ \infty & \left(v_i, v_j\right) \notin E\end{cases}$      无向赋权图类似

  

- 关联矩阵M:  对无向图   $ m_{i j}=\begin{cases}1 &v_{i}与e_{j}关联 \\0 &v_{i}与e_{j}不关联\end{cases}  $   

  ​                      对有向图   $ m_{i j}=\begin{cases}1 &v_{i}是e_{j}的尾 \\-1 & v_{i}是e_{j}的头\\0 &v_{i}与e_{j}不关联\end{cases}  $  

## 图的常见问题及算法

 

- 最短路径问题:求两顶点间权重和最小的一条路径
  - 两指定顶点间: Dijkstra算法

​	1. 选择起点, 引进两个集合S和U.  S的作用是记录已求出最短路径的顶点(以及相应的最短路径长度)，而U则是记录还未求出最短路径的顶点(以及该顶点到起点s的距离), 初始时，S中只有起点；U中是除起点之外的顶点，并且U中顶点的值为与起点关联的边的权重, 不关联记为无穷.

   2. 从U中找出路径最短的顶点, 将其加入S中, 并用当前顶点更新U中各顶点与起点的最短路径(即比较前一步中各顶点路径和以本次操作的顶点为起点到其他顶点的路径加上本次操作的顶点到起点的路径和的大小, 保留较小值进入新的U集合中). 

   3. 重复上述步骤, 直到U中没有顶点, S中就得到各顶点相对于起始点的最短路径. 

      - 任意两顶点间最短路径(Dijkstra算法仍可用, 时间复杂度与下述算法相同)

        Floyd算法

        对邻接矩阵进行迭代, 设邻接矩阵为A~0~ 第k次迭代的矩阵为A~k~ , n为图的阶数, 矩阵A~k~ 的第i行j列元素表示从顶点v~i~到v~j~的路径上所经过的顶点数不大于k的最短路径长度, $A_k(i, j)=min(A_{k-1}(i,j),A_{k-1}(i,k)+A_{k-1}(k,j))$ , 迭代到第n次时得到的矩阵为各顶点间的最短路径.

- 最小生成树问题: 从已有的图中生成一个遍历所有顶点的具有最小权重和的树
  - Kruskal算法: 适合边少点多的图
    1. 把图G中的所有边全部去掉, 得到所有单独的顶点V构成图 T=(V, {空集} )其中V是顶点集合
    2. 从G中取出当前权值最小的边, 如果该边加入T的边的集合后T不形成回路, 则加入T; 否则舍弃
    3. 重复第2步, 直到T中有n−1条边 (n是顶点数)
    4. 若第2步中遇到两条权值相同的最小权值边, 任选一条即可, 所以最小生成树可能不唯一, 但权值之和相同
  - Prim算法: 适合边多点少的图
    1. 设置一个图U, 将原图的任一顶点取出加入U中
    2. 在所有$u\in U$, $v\in(V-U)$的边(u, v)中找到一条权值最小的边, 并入图U中
    3. 重复步骤2直到U中包含了所有顶点
    4. 若第2步中遇到两条权值相同的最小权值边, 任选一条即可, 所以最小生成树可能不唯一, 但权值之和相同
  
- 最大流问题: 在赋权有向图中从某顶点分配流量,使其到终点的流量最大, 每条边上的流量不超过其权值, 且只能按方向流动
  - 基础算法（不一定找到最优解,  但一定能使得“ 管道 “阻塞, 其他最优解算法均以此为基础）
    1. 选择任意一条从起点到终点的路径, 将其中各边权值均减去该路径上最小的权值, 权值为0的边视为断开
    2. 重复步骤1, 直到找不到这样的路径

  - Ford-Fulkerson算法    
  
    在基础算法的步骤1中补充: 添加一条沿着该路径的反向路径, 其边各权值均为减去的数值, 并且在之后寻找路径时, 允许沿着该反向路径流动(作为有向边, 方向相反的边不合并, 方向相同的边合并, 权值相加)
  
    缺点: 若选择的路径的边的权值相差较大时, 重复步骤较多
  
    时间复杂度 $\leq$O(图的总边数*最大流流量)
  
    每轮循环次数$\leq$最大流流量

  - Edmonds-Karp算法
  
    在Ford-Fulkerson算法基础上, 将步骤一中选择任意路径改为选择最短路径(此时将图当做无权图寻找)
  
    时间复杂度: O(图的总边数^2^*顶点数)

  - Dinic算法
  
    level graph: 从起点开始, 按有向图方向, 第一步关联的节点为第一层, 从第一层节点出发再直接关联的为第二层, 直到到终点结束, 高节点不能向同或低层次延申, 保留寻找这样分层的边, 称为level graph 
  
    在原图上构建level graph, 在其中应用基础算法, 将这样寻找到的流动方式再原图中减去, 并添加反向流; 之后根据上一轮更新后的原图, 再次按照上述步骤更新, 反向流也参与level graph的构造, 记得在过程中合并同向的权值,直到找不到从起点到终点的路径
  
    时间复杂度: O(图的总边数*顶点数^2^)
  
    一般来说, 图的边数大于顶点数, 因此时间复杂度更小

- 最小割问题:将图的顶点分不重合的两部分, 定义容量为离开其中一部分的权重值之和, 寻找最小容量

  最小割不唯一

  最大流最小割定理: 最大流流量等于最小割容量

  寻找最小割的方法: 在上述求最大流的方法中,找到最后的图, 忽略反向流, 起点及其一步能到达的点为一部分, 其他点为另一部分, 就是最小割
  
  

- 其他问题
  - 二部图匹配问题：匈牙利算法, HK算法
  - 旅行商问题(NPC): 退火算法, 遗传算法, 蚁群算法等

## BP神经网络

一个具有层级结构的赋权图, 包含输入层, 输出层, 隐含层,  工作时下一层级不会向上一层反馈. BP算法将误差逐层向上反馈, 从而调整权值

- 建立

  对某一层级的一个神经元, 其接收上一层级所有神经元的输出值与权值乘积之和, 如果和达到或超过本神经元的阈值, 则根据定义的激活函数代入和与阈值的差作为变量输出本神经元的值, 若低于阈值则输出为0

  设上一层级每个神经元输出值为x~j~ ,与本神经元的权值为w~ij~(神经元j到i) , 本神经元阈值为b, 令

  X=(x~1~, x~2~, ......), W~i~=(w~i1~, w~i2~, ......)^T^, 

  则本神经元输出值y~i~=f(XW-b), 其中f表示激活函数

  常见的激活函数有

  sigmoid函数: $f(x)=\frac1{1+e^x}$ 一般用于输出层

  tanh函数: $f(x)=\frac{e^x-e^{-x}}{e^x+e^{-x}}$ 一般用于隐含层

  relu函数: $f(x)=max(0, x)$ 一般用于隐含层

  

- 反馈学习(直接上结果)

  在下式中, 带有i下标的表示输入层神经元, j表示隐含层, k表示输出层

  $\eta$表示学习率, x~i~表示第i个输入神经元输入值, y~j~表示第j个隐含层神经元的输出值,d~k~表示第k个输出神经元期望输出, o~k~表示其实际输出, w和v分别表示隐含层到输出层和输入层到隐含层的权值, 其上标N表示第N次迭代得到的修正权值, 下标表示从神经元j到k. 输入层有哪个神经元, 隐含层有m个, 输出层有 l个

  $w_{kj}^N=w_{kj}^{N-1}+\eta (d_k-o_k)y_jf^{'}(\sum_{j=0}^mw_{kj}f(\sum_{i=0}^nv_{ij}x_i))$ 

  $v_{ij}^N=v_{ij}^{N-1}+\eta[\sum_{k=1}^l(d_k-o_k)f^{'}\sum_{j=0}^mw_{kj}f(\sum_{i=0}^nv_{ij}x_i))]y_j^{'}x_i$ 

  

  

## 图论的其他结论和定理

托兰定理: n阶不含三角形的图${|E|}_{max}\leq[\frac{n^2}4]$(这里的中括号是不超过括号里数字的最大整数)

欧拉问题: 有限图是链或圈当且仅当G连通且奇点个数为0或偶数, 当一个图有2k个奇点时, 则图可以且至少能用k笔画成

平面图: 一个图或其同构的边只在顶点处相交

欧拉定理: 记F为面集合, 其中面指由圈内不包含其他顶点的圈围成的区域, 则

​				${|V|}-{|E|}+{|F|}=2$

一个连通平面简单图${|E|}\leq3{|V|}-6$

同胚: 若G^'^ 由G在其各边上插入一些顶点构成, 则G和G^'^同胚

库拉斯托夫定理: G是平面图当且仅当其不包含同胚于K~5~和K~3,3~的子图

哈密顿链/圈: 一条链/圈 经过一次且仅经过一次所有顶点

有关哈密顿的定理: 

1. 二部图如果两部分顶点数不一样, 一定无哈密顿圈

2. G为n阶(n大于等于3)简单图, 则存在哈密顿链的充分条件为对于任意不相邻的两个顶点, 其度之和大于等于n-1

   存在哈密顿圈的充分条件为对于任意不相邻的两个顶点, 其度之和大于等于n, 或者对于任意顶点, 其度总大于等于[n/2]

3. 若G是哈密顿图(存在哈密顿链/圈), 则从G中去掉若干个点以及于它们关联的边得到的图G^'^的连通分支不超过去掉的顶点数量

   

拉姆塞问题:对一个完全图的边进行染色, 求存在同色三角形的最小阶数

​					当只用两种颜色染时, 阶数至少为6.   换一种说法, 当有六人及以上的聚会时, 至少存在三个人彼此间都认识或都不认识.

## 参考资料

[最短路径, 最小生成树, 最大流](https://blog.csdn.net/Serendipity_zyx/article/details/126731133?spm=1001.2101.3001.6650.2&utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-2-126731133-blog-108390998.235^v38^pc_relevant_yljh&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-2-126731133-blog-108390998.235^v38^pc_relevant_yljh&utm_relevant_index=3)

[bp算法推导]([神经网络与BP算法推导_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1Ko4y1o774/?spm_id_from=333.337.top_right_bar_window_history.content.click&vd_source=4e338f355ebd25cac56c3a6157dd0ffc))

[多染色拉姆塞数的一些性质]([离散数学与控制系统(二): 图性质，拉姆齐数 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/145465250))

[二部图最大匹配]([优化 | 二部图最大匹配问题的精确算法详解(HK算法和匈牙利算法)：一份让您满意的【理论介绍+代码实现】学习笔记 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/524349780))

[TSP蚁群算法]([蚁群算法-求解TSP问题 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/95782157))

[TSP模拟退火算法]([(8条消息) 用模拟退火(SA)算法解决旅行商问题_模拟退火算法求解旅行商问题_一只躺在风口的�的博客-CSDN博客](https://blog.csdn.net/wenkang2261/article/details/108948015))

